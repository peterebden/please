name: "Please cache retrieval"
description: "Caches & retrieves parts of the plz cache between runs"
inputs:
  machine:
    required: false
    description: "The type of machine we're running on"
    default: ${{ github.job }}
runs:
  using: "composite"
  steps:
    - name: Cache retrieval
      uses: actions/cache@v3
      with:
        path: .plz-cache/third_party
        key: plz-${{ inputs.machine }}-${{ (startsWith(inputs.machine, 'ubuntu') || inputs.machine == 'alpine') && hashFiles('third_party/go/BUILD', 'third_party/python/BUILD', 'third_party/java/BUILD', format('tools/images/{0}/Dockerfile', inputs.machine)) || hashFiles('third_party/go/BUILD', 'third_party/python/BUILD', 'third_party/java/BUILD') }}
        restore-keys: plz-${{ inputs.machine }}-
